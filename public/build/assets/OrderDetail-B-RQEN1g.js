import{d as X,m as S,q as Y,c,a as s,u as t,h as I,w as l,b as d,t as r,o as m,f as q,e as o,g as w,F as h,r as F,k as ee,i as te,p as T}from"./app-Bf4La2Zj.js";import{d as se,T as le,_ as de}from"./AppLayout.vue_vue_type_script_setup_true_lang-k08uk-99.js";import{d as ae}from"./index-BsePJUay.js";import{_ as y}from"./index-bhJhBn6c.js";import{_ as z}from"./Label.vue_vue_type_script_setup_true_lang-Dlzip7qW.js";import{_ as D}from"./Input.vue_vue_type_script_setup_true_lang-DYBlats5.js";import{_ as oe}from"./Textarea.vue_vue_type_script_setup_true_lang-8br4_xAc.js";import{_ as O}from"./InputError.vue_vue_type_script_setup_true_lang-CxohJFxZ.js";import{_ as ne,a as re,b as ie,c as ue,d as me}from"./DialogTitle.vue_vue_type_script_setup_true_lang-vk3V9_nZ.js";import{_ as fe,a as ce,b as ve,c as pe,d as B}from"./SelectValue.vue_vue_type_script_setup_true_lang-krmKGXCt.js";import{_ as U,a as E,b as C,c as b,d as N,e as _}from"./TableHeader.vue_vue_type_script_setup_true_lang-CXgFr59v.js";import{D as be}from"./download-CI-apGGo.js";import{S as _e}from"./search-CIkdeD6S.js";import"./index-C2lc8lfc.js";import"./VisuallyHidden-DsrwNWNB.js";import"./useForwardExpose-GvThf_1Q.js";import"./useForwardPropsEmits-n8muDEO2.js";import"./createLucideIcon-D0xHvuhb.js";import"./check-vZceLZDF.js";import"./useFormControl-CaexLAn1.js";const ge={class:"flex h-full flex-1 flex-col gap-6 p-6"},ye={class:"flex items-center justify-between"},xe={class:"text-2xl font-bold"},ke={class:"text-sm text-muted-foreground"},we={class:"flex gap-2"},$e=["href"],Ve={class:"grid gap-6 lg:grid-cols-3"},Se={class:"lg:col-span-2 space-y-6"},Pe={class:"rounded-lg border p-6"},he=["src","alt"],Be={key:1,class:"h-12 w-12 rounded bg-muted flex items-center justify-center text-muted-foreground text-xs"},Ce={class:"rounded-lg border p-6"},je={class:"space-y-2 text-sm"},qe={class:"ml-2"},Fe={class:"ml-2"},ze={class:"ml-2"},Te={key:0},De={class:"ml-2"},Oe={key:0,class:"rounded-lg border p-6"},Ue={class:"text-muted-foreground"},Ee={class:"space-y-6"},Ne={class:"rounded-lg border p-6"},Ae={class:"space-y-4"},Ge={class:"space-y-2"},Le={class:"rounded-lg border p-6"},Me={class:"space-y-1 text-sm"},Ke={class:"font-medium"},Qe={class:"rounded-lg border p-6"},Re={class:"flex justify-between items-center text-lg font-bold"},Ze={class:"relative w-full mb-4"},He={class:"relative"},Je={key:0,class:"absolute z-50 w-full mt-1 bg-popover border rounded-md shadow-md max-h-[300px] overflow-y-auto"},We=["onClick"],Xe={class:"font-medium"},Ye={class:"text-sm text-muted-foreground"},Ie={key:1,class:"absolute z-50 w-full mt-1 bg-popover border rounded-md shadow-md p-3 text-sm text-muted-foreground text-center"},et={class:"flex justify-end gap-2"},kt=X({__name:"OrderDetail",props:{order:{},availableProducts:{}},setup(n){const f=n,A=[{title:"Dashboard",href:ae().url},{title:"Bestellingen",href:"/admin/orders"},{title:f.order.order_number}],$=S(f.order.status),P=S(!1),V=S(!1),g=S(""),x=S(!1),u=Y({items:f.order.items.map(i=>({id:i.id,product_id:i.product_id,quantity:i.quantity})),notes:f.order.notes||""}),j=te(()=>{if(!g.value)return f.availableProducts.slice(0,10);const i=g.value.toLowerCase();return f.availableProducts.filter(e=>e.title.toLowerCase().includes(i)).slice(0,10)}),G=()=>!["completed","cancelled"].includes(f.order.status),L=()=>{u.items=f.order.items.map(i=>({id:i.id,product_id:i.product_id,quantity:i.quantity})),u.notes=f.order.notes||"",g.value="",x.value=!1,V.value=!0},M=i=>{const e=f.availableProducts.find(v=>v.id===i);if(!e)return;const a=u.items.find(v=>v.product_id===i);a?a.quantity+=1:u.items.push({id:null,product_id:e.id,quantity:1}),g.value="",x.value=!1},K=()=>{x.value=!0},Q=()=>{setTimeout(()=>{x.value=!1},200)},R=i=>{u.items.splice(i,1)},Z=()=>{u.patch(`/admin/orders/${f.order.id}`,{preserveScroll:!0,onSuccess:()=>{V.value=!1}})},k=i=>new Intl.NumberFormat("nl-NL",{style:"currency",currency:"EUR"}).format(typeof i=="string"?parseFloat(i):i),H=i=>({pending:"secondary",confirmed:"default",completed:"default",cancelled:"destructive"})[i]||"secondary",J=()=>{$.value!==f.order.status&&(P.value=!0,T.patch(`/admin/orders/${f.order.id}/status`,{status:$.value},{preserveScroll:!0,onFinish:()=>{P.value=!1}}))},W=()=>{T.visit("/admin/orders")};return(i,e)=>(m(),c(h,null,[s(t(I),{title:`Bestelling ${n.order.order_number}`},null,8,["title"]),s(de,{breadcrumbs:A},{default:l(()=>[d("div",ge,[d("div",ye,[d("div",null,[d("h1",xe,"Bestelling "+r(n.order.order_number),1),d("p",ke," Geplaatst op "+r(n.order.created_at),1)]),d("div",we,[G()?(m(),q(t(y),{key:0,variant:"outline",onClick:L},{default:l(()=>[...e[5]||(e[5]=[o(" Bestelling aanpassen ",-1)])]),_:1})):w("",!0),n.order.status==="completed"?(m(),c("a",{key:1,href:`/admin/orders/${n.order.id}/invoice`,target:"_blank"},[s(t(y),{variant:"outline"},{default:l(()=>[s(t(be),{class:"h-4 w-4 mr-2"}),e[6]||(e[6]=o(" Factuur downloaden ",-1))]),_:1})],8,$e)):w("",!0),s(t(y),{variant:"outline",onClick:W},{default:l(()=>[...e[7]||(e[7]=[o(" â† Terug naar bestellingen ",-1)])]),_:1})])]),d("div",Ve,[d("div",Se,[d("div",Pe,[e[13]||(e[13]=d("h2",{class:"text-lg font-semibold mb-4"},"Producten",-1)),s(t(U),null,{default:l(()=>[s(t(E),null,{default:l(()=>[s(t(C),null,{default:l(()=>[s(t(b),{class:"w-20"},{default:l(()=>[...e[8]||(e[8]=[o("Foto",-1)])]),_:1}),s(t(b),null,{default:l(()=>[...e[9]||(e[9]=[o("Product",-1)])]),_:1}),s(t(b),null,{default:l(()=>[...e[10]||(e[10]=[o("Prijs",-1)])]),_:1}),s(t(b),null,{default:l(()=>[...e[11]||(e[11]=[o("Aantal",-1)])]),_:1}),s(t(b),null,{default:l(()=>[...e[12]||(e[12]=[o("Subtotaal",-1)])]),_:1})]),_:1})]),_:1}),s(t(N),null,{default:l(()=>[(m(!0),c(h,null,F(n.order.items,(a,v)=>(m(),q(t(C),{key:v},{default:l(()=>[s(t(_),null,{default:l(()=>[a.product_thumbnail?(m(),c("img",{key:0,src:a.product_thumbnail,alt:a.product_title,class:"h-12 w-12 rounded object-cover"},null,8,he)):(m(),c("div",Be," Geen foto "))]),_:2},1024),s(t(_),{class:"font-medium"},{default:l(()=>[o(r(a.product_title),1)]),_:2},1024),s(t(_),null,{default:l(()=>[o(r(k(a.price)),1)]),_:2},1024),s(t(_),null,{default:l(()=>[o(r(a.quantity)+"x",1)]),_:2},1024),s(t(_),{class:"font-medium"},{default:l(()=>[o(r(k(a.subtotal)),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),d("div",Ce,[e[18]||(e[18]=d("h2",{class:"text-lg font-semibold mb-4"},"Klantgegevens",-1)),d("div",je,[d("div",null,[e[14]||(e[14]=d("span",{class:"font-medium"},"Bedrijf:",-1)),d("span",qe,r(n.order.customer.company_name),1)]),d("div",null,[e[15]||(e[15]=d("span",{class:"font-medium"},"Contactpersoon:",-1)),d("span",Fe,r(n.order.customer.contact_person),1)]),d("div",null,[e[16]||(e[16]=d("span",{class:"font-medium"},"Telefoon:",-1)),d("span",ze,r(n.order.customer.phone_number),1)]),n.order.customer.email?(m(),c("div",Te,[e[17]||(e[17]=d("span",{class:"font-medium"},"Email:",-1)),d("span",De,r(n.order.customer.email),1)])):w("",!0)])]),n.order.notes?(m(),c("div",Oe,[e[19]||(e[19]=d("h2",{class:"text-lg font-semibold mb-2"},"Opmerkingen",-1)),d("p",Ue,r(n.order.notes),1)])):w("",!0)]),d("div",Ee,[d("div",Ne,[e[25]||(e[25]=d("h2",{class:"text-lg font-semibold mb-4"},"Status",-1)),d("div",Ae,[d("div",null,[s(t(se),{variant:H(n.order.status),class:"text-sm"},{default:l(()=>[o(r(n.order.status_label),1)]),_:1},8,["variant"])]),d("div",Ge,[s(t(z),{for:"status"},{default:l(()=>[...e[20]||(e[20]=[o("Status wijzigen",-1)])]),_:1}),s(t(fe),{modelValue:$.value,"onUpdate:modelValue":e[0]||(e[0]=a=>$.value=a)},{default:l(()=>[s(t(ce),null,{default:l(()=>[s(t(ve))]),_:1}),s(t(pe),null,{default:l(()=>[s(t(B),{value:"pending"},{default:l(()=>[...e[21]||(e[21]=[o("In behandeling",-1)])]),_:1}),s(t(B),{value:"confirmed"},{default:l(()=>[...e[22]||(e[22]=[o("Bevestigd",-1)])]),_:1}),s(t(B),{value:"completed"},{default:l(()=>[...e[23]||(e[23]=[o("Voltooid",-1)])]),_:1}),s(t(B),{value:"cancelled"},{default:l(()=>[...e[24]||(e[24]=[o("Geannuleerd",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(t(y),{size:"sm",class:"w-full",onClick:J,disabled:P.value||$.value===n.order.status},{default:l(()=>[o(r(P.value?"Bezig...":"Status bijwerken"),1)]),_:1},8,["disabled"])])])]),d("div",Le,[e[26]||(e[26]=d("h2",{class:"text-lg font-semibold mb-4"},"Afleveradres",-1)),d("div",Me,[d("p",Ke,r(n.order.delivery_address.name),1),d("p",null,r(n.order.delivery_address.street_name)+" "+r(n.order.delivery_address.house_number),1),d("p",null,r(n.order.delivery_address.postal_code)+" "+r(n.order.delivery_address.city),1)])]),d("div",Qe,[e[28]||(e[28]=d("h2",{class:"text-lg font-semibold mb-4"},"Totaal",-1)),d("div",Re,[e[27]||(e[27]=d("span",null,"Totaalbedrag:",-1)),d("span",null,r(k(n.order.total)),1)])])])])]),s(t(ne),{open:V.value,"onUpdate:open":e[4]||(e[4]=a=>V.value=a)},{default:l(()=>[s(t(re),{class:"max-w-3xl max-h-[90vh] overflow-y-auto"},{default:l(()=>[s(t(ie),null,{default:l(()=>[s(t(ue),null,{default:l(()=>[...e[29]||(e[29]=[o("Bestelling aanpassen",-1)])]),_:1}),s(t(me),null,{default:l(()=>[...e[30]||(e[30]=[o(" Pas de aantallen en opmerkingen van deze bestelling aan. ",-1)])]),_:1})]),_:1}),d("form",{onSubmit:ee(Z,["prevent"]),class:"space-y-6"},[d("div",null,[s(t(z),{class:"text-base font-semibold mb-4 block"},{default:l(()=>[...e[31]||(e[31]=[o("Producten",-1)])]),_:1}),d("div",Ze,[d("div",He,[s(t(_e),{class:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),s(t(D),{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=a=>g.value=a),type:"text",placeholder:"Zoek product om toe te voegen...",class:"pl-10",onFocus:K,onBlur:Q,disabled:t(u).processing},null,8,["modelValue","disabled"])]),x.value&&j.value.length>0?(m(),c("div",Je,[(m(!0),c(h,null,F(j.value,a=>(m(),c("div",{key:a.id,class:"px-3 py-2 hover:bg-accent cursor-pointer flex items-center justify-between",onClick:v=>M(a.id)},[d("span",Xe,r(a.title),1),d("span",Ye,r(k(a.price)),1)],8,We))),128))])):w("",!0),x.value&&g.value&&j.value.length===0?(m(),c("div",Ie," Geen producten gevonden ")):w("",!0)]),s(t(U),null,{default:l(()=>[s(t(E),null,{default:l(()=>[s(t(C),null,{default:l(()=>[s(t(b),null,{default:l(()=>[...e[32]||(e[32]=[o("Product",-1)])]),_:1}),s(t(b),null,{default:l(()=>[...e[33]||(e[33]=[o("Prijs",-1)])]),_:1}),s(t(b),{class:"w-32"},{default:l(()=>[...e[34]||(e[34]=[o("Aantal",-1)])]),_:1}),s(t(b),{class:"w-20"})]),_:1})]),_:1}),s(t(N),null,{default:l(()=>[(m(!0),c(h,null,F(t(u).items,(a,v)=>(m(),q(t(C),{key:v},{default:l(()=>[s(t(_),{class:"font-medium"},{default:l(()=>[o(r(a.id?n.order.items.find(p=>p.id===a.id)?.product_title:n.availableProducts.find(p=>p.id===a.product_id)?.title),1)]),_:2},1024),s(t(_),null,{default:l(()=>[o(r(a.id?k(n.order.items.find(p=>p.id===a.id)?.price||0):k(n.availableProducts.find(p=>p.id===a.product_id)?.price||0)),1)]),_:2},1024),s(t(_),null,{default:l(()=>[s(t(D),{type:"number",modelValue:a.quantity,"onUpdate:modelValue":p=>a.quantity=p,modelModifiers:{number:!0},min:"1",step:"1",disabled:t(u).processing},null,8,["modelValue","onUpdate:modelValue","disabled"]),s(O,{message:t(u).errors[`items.${v}.quantity`],class:"mt-1"},null,8,["message"])]),_:2},1024),s(t(_),null,{default:l(()=>[s(t(y),{type:"button",variant:"ghost",size:"sm",onClick:p=>R(v),disabled:t(u).processing||t(u).items.length<=1},{default:l(()=>[s(t(le),{class:"h-4 w-4 text-destructive"})]),_:1},8,["onClick","disabled"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),d("div",null,[s(t(z),{for:"notes",class:"mb-[15px] block"},{default:l(()=>[...e[35]||(e[35]=[o("Opmerkingen",-1)])]),_:1}),s(t(oe),{id:"notes",modelValue:t(u).notes,"onUpdate:modelValue":e[2]||(e[2]=a=>t(u).notes=a),placeholder:"Optionele opmerkingen over deze bestelling...",rows:"4",disabled:t(u).processing},null,8,["modelValue","disabled"]),s(O,{message:t(u).errors.notes,class:"mt-1"},null,8,["message"])]),d("div",et,[s(t(y),{type:"button",variant:"outline",onClick:e[3]||(e[3]=a=>V.value=!1),disabled:t(u).processing},{default:l(()=>[...e[36]||(e[36]=[o(" Annuleren ",-1)])]),_:1},8,["disabled"]),s(t(y),{type:"submit",disabled:t(u).processing},{default:l(()=>[o(r(t(u).processing?"Bezig...":"Opslaan"),1)]),_:1},8,["disabled"])])],32)]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{kt as default};
